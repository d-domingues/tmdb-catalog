{"version":3,"file":"search-view.js","sourceRoot":"","sources":["../../../src/views/search-view.ts"],"names":[],"mappings":";AAAA,OAAO,6BAA6B,CAAC;AAGrC,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,UAAU,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,mBAAmB,CAAC;AACnE,OAAO,EAAE,KAAK,EAAE,MAAM,yBAAyB,CAAC;AAGhD,OAAO,EAAE,SAAS,EAAE,MAAM,cAAc,CAAC;AACzC,OAAO,EAAE,iBAAiB,EAAE,aAAa,EAAE,MAAM,gBAAgB,CAAC;AAGlE,IAAa,UAAU,GAAvB,MAAa,UAAW,SAAQ,UAAU;IAA1C;;QA2B8B,aAAQ,GAAmB,SAAS,EAAE,CAAC,QAAQ,CAAC;QACnE,SAAI,GAAG,CAAC,CAAC;IA0CpB,CAAC;IAxCC,MAAM;;QACJ,uDAAuD;QACvD,MAAM,EAAE,WAAW,EAAE,GAAQ,MAAA,IAAI,CAAC,QAAQ,0CAAE,MAAM,CAAC;QAEnD,6FAA6F;QAC7F,MAAM,SAAS,GAA2B,WAAW;YACnD,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC;gBACV,iBAAiB,CAAC,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC;gBACzC,aAAa,CAAC,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC;aACtC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,EAAE;gBAC5B,MAAM,UAAU,GAAQ,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,CAAQ,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,CACrD,CAAC,KAAK,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,UAAU,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;gBAEpD,OAAO,UAAU,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;YACrC,CAAC,CAAC;YACJ,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QAExB,qEAAqE;QACrE,OAAO,KAAK,CACV,SAAS,CAAC,IAAI,CACZ,KAAK,CAAC,EAAE,CACN,IAAI,CAAA;iCACmB,WAAW,IAAI,EAAE;;sBAE5B,KAAK,CAAC,MAAM;YAClB,CAAC,CAAC,2BAA2B;YAC7B,CAAC,CAAC,oDAAoD;uBAC/C,KAAK;;0CAEc,IAAI,CAAC,IAAI,KAAK,CAAC,WAAW,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC;;;6CAG7C,KAAK,CAAC,MAAM,GAAG,EAAE,WAAW,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC;;;WAGpF,CACJ,EACD,IAAI,CAAA,qCAAqC,CAC1C,CAAC;IACJ,CAAC;CACF,CAAA;AArEQ,iBAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;GAwBlB,CAAC;AAE0B;IAA3B,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;4CAAiD;AACnE;IAAR,KAAK,EAAE;wCAAU;AA5BP,UAAU;IADtB,aAAa,CAAC,aAAa,CAAC;GAChB,UAAU,CAsEtB;SAtEY,UAAU","sourcesContent":["import '../components/search-bar.js';\r\n\r\nimport { RouterLocation } from '@vaadin/router';\r\nimport { css, html, LitElement } from 'lit';\r\nimport { customElement, property, state } from 'lit/decorators.js';\r\nimport { until } from 'lit/directives/until.js';\r\n\r\nimport { TmdbDataObj } from '../../models/tmdb-data-obj.js';\r\nimport { getRouter } from '../router.js';\r\nimport { fetchSearchMovies, fetchSearchTv } from '../tmdb.api.js';\r\n\r\n@customElement('search-view')\r\nexport class SearchView extends LitElement {\r\n  static styles = css`\r\n    horizontal-display {\r\n      margin-bottom: 20px;\r\n    }\r\n\r\n    button {\r\n      outline: none;\r\n      padding: 6px 30px;\r\n      cursor: pointer;\r\n      background: cornflowerblue;\r\n      border: 2px solid royalblue;\r\n      border-radius: 6px;\r\n      color: white;\r\n    }\r\n\r\n    button[disabled] {\r\n      opacity: 0.4;\r\n      pointer-events: none;\r\n      cursor: not-allowed;\r\n    }\r\n\r\n    button#forward {\r\n      float: right;\r\n    }\r\n  `;\r\n\r\n  @property({ type: Object }) location: RouterLocation = getRouter().location;\r\n  @state() page = 1;\r\n\r\n  render() {\r\n    // gets the searched term trough the routing parameters\r\n    const { searchQuery }: any = this.location?.params;\r\n\r\n    // this var gets updated everytime the state property 'page' changes performing a new request\r\n    const fetchData: Promise<TmdbDataObj[]> = searchQuery\r\n      ? Promise.all([\r\n          fetchSearchMovies(searchQuery, this.page),\r\n          fetchSearchTv(searchQuery, this.page),\r\n        ]).then(([movies, tvShows]) => {\r\n          const interleave: any = ([x, ...xs]: any[], ys = []) =>\r\n            x === undefined ? ys : [x, ...interleave(ys, xs)];\r\n\r\n          return interleave(movies, tvShows);\r\n        })\r\n      : Promise.resolve([]);\r\n\r\n    // renders a loading spinner until the asynchronous data is resolverd\r\n    return until(\r\n      fetchData.then(\r\n        items =>\r\n          html`\r\n            <search-bar .value=${searchQuery || ''}></search-bar>\r\n            <horizontal-display\r\n              title=${items.length\r\n                ? 'Resultados de la bÃºsqueda'\r\n                : 'No hay registros para los criterios seleccionados!'}\r\n              .items=${items}\r\n            ></horizontal-display>\r\n            <button id=\"back\" ?disabled=${this.page === 1} @click=${() => (this.page -= 1)}>\r\n              Anterior\r\n            </button>\r\n            <button id=\"forward\" ?disabled=${items.length < 40} @click=${() => (this.page += 1)}>\r\n              Siguiente\r\n            </button>\r\n          `\r\n      ),\r\n      html`<loading-spinner></loading-spinner>`\r\n    );\r\n  }\r\n}\r\n"]}